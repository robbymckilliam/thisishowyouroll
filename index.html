<!--
    Calculator for DnD dice rolls
    Copyright (C) 2016  Robby McKilliam

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->

<!DOCTYPE html>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<html>
<body>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link href="c3.min.css" rel="stylesheet" type="text/css">
    <script src="d3.min.js" charset="utf-8"></script>
    <script src="c3.min.js"></script>
    <script src="thisishowyouroll.js"></script>
    
    <div id="plotcontainer" class="container hidden">
      <div class="well">
	<div id="pmfplot"></div>
      </div>
    </div>

    <div id="diceresultsontainer"  class="container">
      <div class="well">
	<div id="requiredroll"></div>
	<table class="table table-condensed">
	  <thead>
	    <tr>
              <th>Roll</th>
              <th>Probability of success</th>
	    </tr>
	  </thead>
	  <tbody id="diceresults">
	  </tbody>
	</table>
	<div id="bestroll"></div>
      </div>
    </div>

    <div class="container">
      <form id="rollform">
    <div class="form-group">
    <input type="text" class="form-control" id="rollstring" placeholder="Example: 12 with 4d4 + 4 or 2d8 + 1d6 + 2 o r2d12 + 1d6">
    </div>
    </form>
    </div>
    
    <div class="container text-center">
    <div class="btn-group-vertical">
    <button type="button" class="btn btn-default" onclick="button_1()">1</button> 
    <button type="button" class="btn btn-default" onclick="button_4()">4</button>
    <button type="button" class="btn btn-default" onclick="button_7()">7</button>
    <button type="button" class="btn btn-default" onclick="button_d()">d</button>
    <button type="button" class="btn btn-default" onclick="button_switch_stats()"><span class="glyphicon glyphicon-stats"></span></button>
    </div>
    <div class="btn-group-vertical">
    <button type="button" class="btn btn-default" onclick="button_2()">2</button> 
    <button type="button" class="btn btn-default" onclick="button_5()">5</button>
    <button type="button" class="btn btn-default" onclick="button_8()">8</button>
    <button type="button" class="btn btn-default" onclick="button_0()">0</button>
    <button type="button" class="btn btn-default" onclick="button_is()">is</button>
    </div>
    <div class="btn-group-vertical">
    <button type="button" class="btn btn-default" onclick="button_3()">3</button> 
    <button type="button" class="btn btn-default" onclick="button_6()">6</button>
    <button type="button" class="btn btn-default" onclick="button_9()">9</button>
    <button type="button" class="btn btn-default" onclick="button_plus()">+</button>
    <button type="button" class="btn btn-default" onclick="button_or()">or</button>
    </div>
    <div class="btn-group-vertical">
    <button type="button" class="btn btn-default" onclick="button_with()">with</button> 
    <button type="button" class="btn btn-default" onclick="button_where()">where</button>
    <button type="button" class="btn btn-default" onclick="button_iffail()">iffail</button>
    <button type="button" class="btn btn-default" onclick="button_BACK()">BACK</i></button> 
    <button type="button" class="btn btn-default" onclick="button_CLEAR()">CLEAR</button>
    </div>

<script>

  var pmfplot = c3.generate({
  bindto: '#pmfplot',
  data: {
  columns: [],
  type: 'area-step'
  },
  title: {
  text: 'Probability of success'
  }
  });

  // support input query string
  document.getElementById("rollstring").value = window.location.search.substring(1);

  // Keypresses go to form
  document.getElementById("rollform").addEventListener('keyup', function(e) {
//    console.log("Submitted test " + document.getElementById("rollstring").value);
    e.preventDefault();
    regenerate_results();
}, false);
  
  regenerate_results();
  
</script>


</body>
</html>

